
Reports_Detail_Js("Reports_ChartDetailView_Js",{displayNoDataMessage:function(){$("#chartcontent").html("<div>"+app.vtranslate("JS_NO_CHART_DATA_AVAILABLE")+"</div>").css({"text-align":"center",position:"relative",top:"100px"})},isEmptyData:function(){var b=jQuery("input[name=data]").val();var c=JSON.parse(b);var a=c.values;if(b==""||a==""){return true}return false}},{getInstance:function(){var c=jQuery("input[name=charttype]").val();var b=c.toCamelCase();var d=window["Report_"+b+"_Js"];var a=false;if(typeof d!="undefined"){a=new d();a.postInitializeCalls()}return a},registerSaveOrGenerateReportEvent:function(){var a=this;jQuery(".generateReport").on("click",function(h){if(!jQuery("#chartDetailForm").validationEngine("validate")){h.preventDefault();return false}var i=a.calculateValues();var f=$('[name="recordId"').val();var g=jQuery(h.currentTarget).data("mode");var b={advanced_filter:i,record:f,view:"ChartSaveAjax",module:app.getModuleName(),mode:g,charttype:jQuery("input[name=charttype]").val(),groupbyfield:jQuery("#groupbyfield").val(),datafields:jQuery("#datafields").val()};var d=a.getContentHolder().find("#reportContentsDiv");var c=jQuery("<div></div>");c.progressIndicator({position:"html",blockInfo:{enabled:true,elementToBlock:d}});h.preventDefault();AppConnector.request(b).then(function(e){c.progressIndicator({mode:"hide"});d.html(e);a.registerEventForChartGeneration()})})},registerEventForChartGeneration:function(){var b=this;try{b.getInstance();jQuery("#chartcontent").trigger(Vtiger_Widget_Js.widgetPostLoadEvent)}catch(a){Reports_ChartDetailView_Js.displayNoDataMessage();return}},registerEventForModifyCondition:function(){jQuery("button[name=modify_condition]").on("click",function(){var b=jQuery("#filterContainer");var a=jQuery(this).find("span");var c=a.attr("class");if(c.indexOf("glyphicon-chevron-right")!=-1){a.removeClass("glyphicon-chevron-right").addClass("glyphicon-chevron-down");b.removeClass("hide").show("slow")}else{a.removeClass("glyphicon-chevron-down").addClass("glyphicon-chevron-right");b.hide("slow")}return false})},registerEvents:function(){this._super();this.registerEventForModifyCondition();this.registerEventForChartGeneration();Reports_ChartEdit3_Js.registerFieldForChosen();Reports_ChartEdit3_Js.initSelectValues();jQuery("#chartDetailForm").validationEngine(app.validationEngineOptions)}});Vtiger_Pie_Widget_Js("Report_Piechart_Js",{},{postInitializeCalls:function(){var b=jQuery("input[name=clickthrough]").val();if(b!=""){var a=this;this.getContainer().on("jqplotDataClick",function(c,e,f,g){var d=a.data.links[f];if(d){window.location.href=d}});this.getContainer().on("jqplotDataHighlight",function(c,d,e,f){$(".jqplot-event-canvas").css("cursor","pointer")});this.getContainer().on("jqplotDataUnhighlight",function(c,d,e,f){$(".jqplot-event-canvas").css("cursor","auto")})}},postLoadWidget:function(){if(!Reports_ChartDetailView_Js.isEmptyData()){this.loadChart()}else{this.positionNoDataMsg()}},positionNoDataMsg:function(){Reports_ChartDetailView_Js.displayNoDataMessage()},getPlotContainer:function(b){if(typeof b=="undefined"){b=false}if(this.plotContainer==false||!b){var a=this.getContainer();this.plotContainer=jQuery("#chartcontent")}return this.plotContainer},init:function(){this._super(jQuery("#reportContentsDiv"))},generateData:function(){if(Reports_ChartDetailView_Js.isEmptyData()){Reports_ChartDetailView_Js.displayNoDataMessage();return false}var c=jQuery("input[name=data]").val();var e=this.data=JSON.parse(c);var a=e.values;var d=[];for(var b in a){d[b]=[];d[b].push(e.labels[b]);d[b].push(a[b])}return{chartData:d,labels:e.labels,data_labels:e.data_labels,title:e.graph_label}}});Vtiger_Barchat_Widget_Js("Report_Verticalbarchart_Js",{},{postInitializeCalls:function(){jQuery("table.jqplot-table-legend").css("width","95px");var a=this;this.getContainer().on("jqplotDataClick",function(d,c,g,f,e){var b=a.data.links[f[0]-1];if(b){window.location.href=b}});this.getContainer().on("jqplotDataHighlight",function(b,c,d,e){$(".jqplot-event-canvas").css("cursor","pointer")});this.getContainer().on("jqplotDataUnhighlight",function(b,c,d,e){$(".jqplot-event-canvas").css("cursor","auto")})},postLoadWidget:function(){if(!Reports_ChartDetailView_Js.isEmptyData()){this.loadChart()}else{this.positionNoDataMsg()}this.postInitializeCalls()},positionNoDataMsg:function(){Reports_ChartDetailView_Js.displayNoDataMessage()},getPlotContainer:function(b){if(typeof b=="undefined"){b=false}if(this.plotContainer==false||!b){var a=this.getContainer();this.plotContainer=jQuery("#chartcontent")}return this.plotContainer},init:function(){this._super(jQuery("#reportContentsDiv"))},generateChartData:function(){if(Reports_ChartDetailView_Js.isEmptyData()){Reports_ChartDetailView_Js.displayNoDataMessage();return false}var h=jQuery("input[name=data]").val();var d=this.data=JSON.parse(h);var k=d.values;var b=[];var f=0;if(d.type=="singleBar"){b[0]=[];for(var e in k){var g=k[e];for(var c in g){b[0].push(g[c]);if(g[c]>f){f=g[c]}}}}else{b[0]=[];b[1]=[];b[2]=[];for(var e in k){var g=k[e];var a=[];for(var c in g){b[c].push(g[c]);if(g[c]>f){f=g[c]}}}}f=f+(f*0.15);return{chartData:b,yMaxValue:f,labels:d.labels,data_labels:d.data_labels,title:d.graph_label}}});Report_Verticalbarchart_Js("Report_Horizontalbarchart_Js",{},{generateChartData:function(){if(Reports_ChartDetailView_Js.isEmptyData()){Reports_ChartDetailView_Js.displayNoDataMessage();return false}var e=jQuery("input[name=data]").val();var g=this.data=JSON.parse(e);var a=g.values;var f=[];var c=0;if(g.type=="singleBar"){for(var d in a){var h=a[d];f[d]=[];for(var b in h){f[d].push(h[b]);f[d].push(parseInt(d)+1);if(h[b]>c){c=h[b]}}}f=[f]}else{f=[];f[0]=[];f[1]=[];f[2]=[];for(var d in a){var h=a[d];for(var b in h){f[b][d]=[];f[b][d].push(h[b]);f[b][d].push(parseInt(d)+1);if(h[b]>c){c=h[b]}}}}c=c+(c*0.15);return{chartData:f,yMaxValue:c,labels:g.labels,data_labels:g.data_labels,title:g.graph_label}},loadChart:function(){var a=this.generateChartData();var b=a.labels;jQuery.jqplot("chartcontent",a.chartData,{title:a.title,animate:!$.jqplot.use_excanvas,seriesDefaults:{renderer:$.jqplot.BarRenderer,showDataLabels:true,pointLabels:{show:true,location:"e",edgeTolerance:-15},shadowAngle:135,rendererOptions:{barDirection:"horizontal"}},axes:{yaxis:{tickRenderer:jQuery.jqplot.CanvasAxisTickRenderer,renderer:jQuery.jqplot.CategoryAxisRenderer,ticks:b,tickOptions:{angle:-45}}},legend:{show:true,location:"e",placement:"outside",showSwatch:true,showLabels:true,labels:a.data_labels}});jQuery("table.jqplot-table-legend").css("width","95px")},postInitializeCalls:function(){var a=this;this.getContainer().on("jqplotDataClick",function(d,c,g,f,e){var b=a.data.links[f[1]-1];if(b){window.location.href=b}});this.getContainer().on("jqplotDataHighlight",function(b,c,d,e){$(".jqplot-event-canvas").css("cursor","pointer")});this.getContainer().on("jqplotDataUnhighlight",function(b,c,d,e){$(".jqplot-event-canvas").css("cursor","auto")})}});Report_Verticalbarchart_Js("Report_Linechart_Js",{},{generateData:function(){if(Reports_ChartDetailView_Js.isEmptyData()){Reports_ChartDetailView_Js.displayNoDataMessage();return false}var e=jQuery("input[name=data]").val();var h=this.data=JSON.parse(e);var a=h.values;var g=[];var c=0;g[1]=[];g[2]=[];g[0]=[];for(var d in a){var f=a[d];for(var b in f){g[b].push(f[b])}}c=c+c*0.15;return{chartData:g,yMaxValue:c,labels:h.labels,data_labels:h.data_labels,title:h.graph_label}},loadChart:function(){var a=this.generateData();var b=$.jqplot("chartcontent",a.chartData,{title:a.title,legend:{show:true,labels:a.data_labels,location:"ne",showSwatch:true,showLabels:true,placement:"outside"},seriesDefaults:{pointLabels:{show:true}},axes:{xaxis:{min:0,pad:1,renderer:$.jqplot.CategoryAxisRenderer,ticks:a.labels,tickOptions:{formatString:"%b %#d"}}},cursor:{show:true}});jQuery("table.jqplot-table-legend").css("width","95px")}});$(document).ready(function(){(new Reports_ChartDetailView_Js()).registerEvents()});